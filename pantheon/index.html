<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collina Trebovanje</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0b;
            --bg-secondary: #141416;
            --bg-card: #1a1a1f;
            --bg-hover: #252530;
            --bg-input: #0d0d0e;
            --accent: #8B5CF6;
            --accent-glow: rgba(139, 92, 246, 0.3);
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --text-primary: #fafafa;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;
            --border: #27272a;
            --border-light: #3f3f46;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.5;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid var(--border);
            margin-bottom: 24px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent), #a78bfa);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
        }

        .logo h1 {
            font-size: 22px;
            font-weight: 600;
        }

        /* Store Selector */
        .store-selector {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .store-selector label {
            font-size: 14px;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .store-selector select {
            flex: 1;
            max-width: 300px;
            padding: 12px 16px;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 15px;
            font-weight: 500;
        }

        .store-selector select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        .store-info {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--text-muted);
        }

        .store-info .dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
        }

        /* Products Table */
        .products-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }

        .table-header {
            display: grid;
            grid-template-columns: 2fr 100px 120px 100px;
            gap: 12px;
            padding: 14px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
        }

        .table-header .col-center {
            text-align: center;
        }

        .product-row {
            display: grid;
            grid-template-columns: 2fr 100px 120px 100px;
            gap: 12px;
            padding: 14px 20px;
            border-bottom: 1px solid var(--border);
            align-items: center;
            transition: background 0.15s;
        }

        .product-row:last-child {
            border-bottom: none;
        }

        .product-row:hover {
            background: var(--bg-hover);
        }

        .product-row.has-request {
            background: rgba(139, 92, 246, 0.08);
        }

        .product-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .product-name {
            font-weight: 500;
            font-size: 14px;
        }

        .product-sku {
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            color: var(--text-muted);
        }

        .stock-cell {
            text-align: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 15px;
            font-weight: 600;
        }

        .stock-low {
            color: var(--warning);
        }

        .stock-critical {
            color: var(--danger);
        }

        .stock-ok {
            color: var(--text-primary);
        }

        .stock-empty {
            color: var(--danger);
            opacity: 0.7;
        }

        .stock-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .stock-indicator .icon {
            font-size: 12px;
        }

        .request-input-wrap {
            position: relative;
        }

        .request-input {
            width: 100%;
            padding: 10px 12px;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            text-align: center;
            transition: all 0.2s;
        }

        .request-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        .request-input:not(:placeholder-shown) {
            background: rgba(139, 92, 246, 0.15);
            border-color: var(--accent);
        }

        .request-input::placeholder {
            color: var(--text-muted);
            opacity: 0.5;
        }

        .central-stock {
            text-align: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .central-stock.insufficient {
            color: var(--danger);
        }

        /* Summary Footer */
        .summary-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border);
        }

        .summary-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .summary-stat {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .summary-stat strong {
            color: var(--accent);
            font-family: 'JetBrains Mono', monospace;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent), #a78bfa);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--accent-glow);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Active Orders Panel */
        .orders-panel {
            margin-top: 24px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }

        .orders-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
        }

        .orders-header h2 {
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .orders-header h2 .badge {
            background: var(--accent);
            color: white;
            font-size: 11px;
            padding: 4px 10px;
            border-radius: 20px;
        }

        .filter-tabs {
            display: flex;
            gap: 6px;
        }

        .filter-tab {
            padding: 6px 14px;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 12px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
        }

        .filter-tab:hover {
            border-color: var(--border-light);
        }

        .filter-tab.active {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .order-card {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 14px 20px;
            border-bottom: 1px solid var(--border);
            transition: background 0.15s;
        }

        .order-card:last-child {
            border-bottom: none;
        }

        .order-card:hover {
            background: var(--bg-hover);
        }

        .order-artikal {
            flex: 1;
            font-weight: 500;
        }

        .order-route {
            font-size: 12px;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .order-qty {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: var(--accent);
            min-width: 60px;
            text-align: center;
        }

        .order-time {
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            color: var(--text-muted);
            min-width: 100px;
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            min-width: 80px;
            text-align: center;
        }

        .status-zatrazeno { background: rgba(59, 130, 246, 0.15); color: var(--info); }
        .status-poslato { background: rgba(245, 158, 11, 0.15); color: var(--warning); }
        .status-na-putu { background: rgba(139, 92, 246, 0.15); color: var(--accent); }
        .status-primljeno { background: rgba(34, 197, 94, 0.15); color: var(--success); }

        .order-actions {
            display: flex;
            gap: 6px;
        }

        .btn-sm {
            padding: 6px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            font-size: 11px;
            cursor: pointer;
            transition: all 0.15s;
        }

        .btn-sm:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .btn-sm.primary {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .empty-orders {
            padding: 40px;
            text-align: center;
            color: var(--text-muted);
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--bg-card);
            border: 1px solid var(--success);
            border-radius: 12px;
            padding: 14px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 200;
        }

        .toast.show {
            transform: translateX(0);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }

            .store-selector {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }

            .store-selector select {
                max-width: none;
            }

            .store-info {
                margin-left: 0;
                justify-content: center;
            }

            .table-header {
                display: none;
            }

            .product-row {
                grid-template-columns: 1fr;
                gap: 8px;
                padding: 16px;
            }

            .product-info {
                margin-bottom: 8px;
            }

            .product-row > div:not(.product-info) {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .product-row > div:not(.product-info)::before {
                font-size: 11px;
                color: var(--text-muted);
                text-transform: uppercase;
            }

            .stock-cell::before { content: 'Stanje u radnji'; }
            .request-input-wrap::before { content: 'Naruƒçi'; }
            .central-stock::before { content: 'Centrala'; }

            .summary-footer {
                flex-direction: column;
                gap: 16px;
            }

            .summary-info {
                width: 100%;
                justify-content: center;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .orders-header {
                flex-direction: column;
                gap: 12px;
            }

            .order-card {
                flex-wrap: wrap;
                gap: 10px;
            }

            .order-artikal {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">C</div>
                <h1>Trebovanje</h1>
            </div>
        </header>

        <!-- Store Selector -->
        <div class="store-selector">
            <label>Radnja:</label>
            <select id="store-select" onchange="changeStore()">
                <!-- Populated by JS -->
            </select>
            <div class="store-info">
                <span class="dot"></span>
                <span>Povezano sa Pantheon</span>
            </div>
        </div>

        <!-- Products Table -->
        <div class="products-panel">
            <div class="table-header">
                <div>Artikal</div>
                <div class="col-center">Radnja</div>
                <div class="col-center">Naruƒçi</div>
                <div class="col-center">Centrala</div>
            </div>
            <div id="products-list">
                <!-- Populated by JS -->
            </div>
            <div class="summary-footer">
                <div class="summary-info">
                    <div class="summary-stat">
                        Artikala: <strong id="summary-items">0</strong>
                    </div>
                    <div class="summary-stat">
                        Ukupno kom: <strong id="summary-qty">0</strong>
                    </div>
                </div>
                <button class="btn btn-primary" id="submit-btn" onclick="submitRequest()" disabled>
                    üì¶ Po≈°alji Trebovanje
                </button>
            </div>
        </div>

        <!-- Active Orders -->
        <div class="orders-panel">
            <div class="orders-header">
                <h2>
                    Aktivna Trebovanja 
                    <span class="badge" id="orders-count">0</span>
                </h2>
                <div class="filter-tabs">
                    <button class="filter-tab active" data-filter="all">Sva</button>
                    <button class="filter-tab" data-filter="zatrazeno">Zatra≈æeno</button>
                    <button class="filter-tab" data-filter="poslato">Poslato</button>
                    <button class="filter-tab" data-filter="na-putu">Na putu</button>
                </div>
            </div>
            <div id="orders-list">
                <div class="empty-orders">Nema aktivnih trebovanja</div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <span>‚úì</span>
        <span id="toast-message">Uspe≈°no!</span>
    </div>

    <script>
        // ============================================
        // TEST DATA - ZAMENI SA PANTHEON PODACIMA
        // ============================================
        
        const artikli = [
            { id: 'ART001', sifra: 'CC05', naziv: 'Coca Cola 0.5L', barcode: '5449000000996' },
            { id: 'ART002', sifra: 'FN05', naziv: 'Fanta 0.5L', barcode: '5449000011527' },
            { id: 'ART003', sifra: 'SP05', naziv: 'Sprite 0.5L', barcode: '5449000014535' },
            { id: 'ART004', sifra: 'HBN1', naziv: 'Hamburger bun', barcode: '8600000000001' },
            { id: 'ART005', sifra: 'BRG2', naziv: 'Goveƒëi burger 200g', barcode: '8600000000002' },
            { id: 'ART006', sifra: 'CHD1', naziv: 'Cheddar sir', barcode: '8600000000003' },
            { id: 'ART007', sifra: 'SLN1', naziv: 'Slanina', barcode: '8600000000004' },
            { id: 'ART008', sifra: 'PMF2', naziv: 'Pomfrit 2.5kg', barcode: '8600000000005' },
            { id: 'ART009', sifra: 'KCP1', naziv: 'Keƒçap 1L', barcode: '8600000000006' },
            { id: 'ART010', sifra: 'MJN1', naziv: 'Majonez 1L', barcode: '8600000000007' }
        ];

        const magacini = [
            { id: 'centrala', naziv: 'Centralni magacin' },
            { id: 'vracar', naziv: 'Vraƒçar' },
            { id: 'banovo', naziv: 'Banovo Brdo' },
            { id: 'nbg', naziv: 'Novi Beograd' },
            { id: 'smash', naziv: 'SMASH Centar' }
        ];

        // Simulirano stanje - U PRODUKCIJI OVO DOLAZI IZ PANTHEONA
        const stpitrovanja = {
            centrala: { ART001: 340, ART002: 120, ART003: 89, ART004: 250, ART005: 180, ART006: 95, ART007: 60, ART008: 45, ART009: 30, ART010: 55 },
            vracar: { ART001: 12, ART002: 3, ART003: 45, ART004: 8, ART005: 15, ART006: 4, ART007: 2, ART008: 6, ART009: 8, ART010: 3 },
            banovo: { ART001: 25, ART002: 18, ART003: 12, ART004: 30, ART005: 22, ART006: 10, ART007: 8, ART008: 4, ART009: 5, ART010: 7 },
            nbg: { ART001: 8, ART002: 5, ART003: 20, ART004: 15, ART005: 10, ART006: 6, ART007: 3, ART008: 2, ART009: 4, ART010: 2 },
            smash: { ART001: 30, ART002: 22, ART003: 35, ART004: 40, ART005: 28, ART006: 15, ART007: 12, ART008: 8, ART009: 10, ART010: 9 }
        };

        // Minimalne koliƒçine za upozorenje
        const minStanje = {
            ART001: 15, ART002: 10, ART003: 15, ART004: 20, ART005: 15, 
            ART006: 8, ART007: 5, ART008: 5, ART009: 5, ART010: 5
        };

        // ============================================
        // STATE
        // ============================================
        
        let currentStore = 'vracar';
        let trebovanja = JSON.parse(localStorage.getItem('trebovanja') || '[]');
        let currentFilter = 'all';

        // ============================================
        // INIT
        // ============================================
        
        function init() {
            populateStoreSelect();
            renderProducts();
            renderOrders();
            setupFilterTabs();
        }

        function populateStoreSelect() {
            const select = document.getElementById('store-select');
            magacini
                .filter(m => m.id !== 'centrala')
                .forEach(m => {
                    select.innerHTML += `<option value="${m.id}">${m.naziv}</option>`;
                });
            select.value = currentStore;
        }

        function changeStore() {
            currentStore = document.getElementById('store-select').value;
            renderProducts();
        }

        function setupFilterTabs() {
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentFilter = tab.dataset.filter;
                    renderOrders();
                });
            });
        }

        // ============================================
        // RENDER PRODUCTS
        // ============================================
        
        function renderProducts() {
            const container = document.getElementById('products-list');
            const storeStock = stpitrovanja[currentStore];
            const centralStock = stpitrovanja.centrala;

            container.innerHTML = artikli.map(art => {
                const sStock = storeStock[art.id] || 0;
                const cStock = centralStock[art.id] || 0;
                const minQty = minStanje[art.id] || 10;
                
                let stockClass = 'stock-ok';
                let stockIcon = '';
                if (sStock === 0) {
                    stockClass = 'stock-critical';
                    stockIcon = 'üî¥';
                } else if (sStock <= minQty) {
                    stockClass = 'stock-low';
                    stockIcon = '‚ö†Ô∏è';
                }

                return `
                    <div class="product-row" id="row-${art.id}">
                        <div class="product-info">
                            <span class="product-name">${art.naziv}</span>
                            <span class="product-sku">${art.sifra}</span>
                        </div>
                        <div class="stock-cell ${stockClass}">
                            <span class="stock-indicator">
                                <span>${sStock}</span>
                                ${stockIcon ? `<span class="icon">${stockIcon}</span>` : ''}
                            </span>
                        </div>
                        <div class="request-input-wrap">
                            <input type="number" 
                                   class="request-input" 
                                   id="req-${art.id}"
                                   placeholder="0" 
                                   min="0"
                                   data-art-id="${art.id}"
                                   data-central="${cStock}"
                                   onchange="updateSummary()"
                                   oninput="checkAvailability(this)">
                        </div>
                        <div class="central-stock" id="central-${art.id}">${cStock}</div>
                    </div>
                `;
            }).join('');

            updateSummary();
        }

        function checkAvailability(input) {
            const artId = input.dataset.artId;
            const centralStock = parseInt(input.dataset.central);
            const requested = parseInt(input.value) || 0;
            const centralCell = document.getElementById(`central-${artId}`);
            const row = document.getElementById(`row-${artId}`);

            if (requested > centralStock) {
                centralCell.classList.add('insufficient');
                centralCell.innerHTML = `${centralStock} ‚ùå`;
            } else {
                centralCell.classList.remove('insufficient');
                centralCell.textContent = centralStock;
            }

            row.classList.toggle('has-request', requested > 0);
            updateSummary();
        }

        function updateSummary() {
            let totalItems = 0;
            let totalQty = 0;

            document.querySelectorAll('.request-input').forEach(input => {
                const qty = parseInt(input.value) || 0;
                if (qty > 0) {
                    totalItems++;
                    totalQty += qty;
                }
            });

            document.getElementById('summary-items').textContent = totalItems;
            document.getElementById('summary-qty').textContent = totalQty;
            document.getElementById('submit-btn').disabled = totalItems === 0;
        }

        // ============================================
        // SUBMIT REQUEST
        // ============================================
        
        function submitRequest() {
            const storeName = magacini.find(m => m.id === currentStore).naziv;
            let hasInsufficientStock = false;

            document.querySelectorAll('.request-input').forEach(input => {
                const qty = parseInt(input.value) || 0;
                if (qty > 0) {
                    const artId = input.dataset.artId;
                    const centralStock = parseInt(input.dataset.central);
                    
                    if (qty > centralStock) {
                        hasInsufficientStock = true;
                        return;
                    }

                    const artikal = artikli.find(a => a.id === artId);
                    
                    const trebovanje = {
                        id: Date.now() + Math.random(),
                        artikal: artikal,
                        iz: { id: 'centrala', naziv: 'Centralni magacin' },
                        u: { id: currentStore, naziv: storeName },
                        kolicina: qty,
                        status: 'zatrazeno',
                        kreirano: new Date().toISOString()
                    };

                    trebovanja.unshift(trebovanje);
                    input.value = '';
                }
            });

            if (hasInsufficientStock) {
                alert('Neka trebovanja prema≈°uju stanje u centrali! Ispravite koliƒçine.');
                return;
            }

            localStorage.setItem('trebovanja', JSON.stringify(trebovanja));
            renderProducts();
            renderOrders();
            showToast('Trebovanje poslato!');
        }

        // ============================================
        // ORDERS
        // ============================================
        
        function renderOrders() {
            const container = document.getElementById('orders-list');
            
            let filtered = trebovanja.filter(t => t.status !== 'primljeno');
            if (currentFilter !== 'all') {
                filtered = filtered.filter(t => t.status === currentFilter);
            }

            document.getElementById('orders-count').textContent = 
                trebovanja.filter(t => t.status !== 'primljeno').length;

            if (filtered.length === 0) {
                container.innerHTML = '<div class="empty-orders">Nema aktivnih trebovanja</div>';
                return;
            }

            container.innerHTML = filtered.map(t => `
                <div class="order-card">
                    <div class="order-artikal">
                        <div>${t.artikal.naziv}</div>
                        <div class="order-route">
                            ${t.iz.naziv} <span>‚Üí</span> ${t.u.naziv}
                        </div>
                    </div>
                    <div class="order-qty">√ó${t.kolicina}</div>
                    <div class="order-time">${formatTime(t.kreirano)}</div>
                    <span class="status-badge status-${t.status}">${formatStatus(t.status)}</span>
                    <div class="order-actions">
                        ${getNextButton(t)}
                        <button class="btn-sm" onclick="deleteOrder('${t.id}')">‚úï</button>
                    </div>
                </div>
            `).join('');
        }

        function getNextButton(t) {
            const flow = { 'zatrazeno': 'poslato', 'poslato': 'na-putu', 'na-putu': 'primljeno' };
            const next = flow[t.status];
            if (!next) return '';
            
            const labels = { 'poslato': 'Poslato', 'na-putu': 'Na putu', 'primljeno': 'Primljeno' };
            return `<button class="btn-sm primary" onclick="updateStatus('${t.id}', '${next}')">${labels[next]}</button>`;
        }

        function updateStatus(id, newStatus) {
            const t = trebovanja.find(t => t.id == id);
            if (t) {
                t.status = newStatus;
                
                if (newStatus === 'primljeno') {
                    // Simulacija upisa u Pantheon
                    console.log('=== PANTHEON UPIS ===');
                    console.log(`${t.artikal.naziv}: ${t.iz.naziv} -${t.kolicina} ‚Üí ${t.u.naziv} +${t.kolicina}`);
                    
                    // Update lokalnog stanja za demo
                    stpitrovanja[t.iz.id][t.artikal.id] -= t.kolicina;
                    stpitrovanja[t.u.id][t.artikal.id] += t.kolicina;
                    renderProducts();
                }
                
                localStorage.setItem('trebovanja', JSON.stringify(trebovanja));
                renderOrders();
                showToast(`Status: ${formatStatus(newStatus)}`);
            }
        }

        function deleteOrder(id) {
            if (confirm('Obri≈°i trebovanje?')) {
                trebovanja = trebovanja.filter(t => t.id != id);
                localStorage.setItem('trebovanja', JSON.stringify(trebovanja));
                renderOrders();
            }
        }

        function formatStatus(s) {
            return { 'zatrazeno': 'Zatra≈æeno', 'poslato': 'Poslato', 'na-putu': 'Na putu', 'primljeno': 'Primljeno' }[s];
        }

        function formatTime(iso) {
            return new Date(iso).toLocaleString('sr-RS', { day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit' });
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // Start
        init();
    </script>
</body>
</html>
